schema: '2.0'
stages:
  clean_data:
    cmd: python src\data\clean_data.py
    deps:
    - path: data\training
      md5: 7a96cfa2ff8c169761a068447405c17e.dir
      size: 5926077
      nfiles: 3
    - path: src\data\clean_data.py
      md5: 446fefd52294d288399ab790a42b6388
      size: 2633
    outs:
    - path: data\prepared
      md5: 15682c488e4b458bdc8b68fb97c82852.dir
      size: 591595
      nfiles: 1
  generate_training_features:
    cmd: python -W ignore src\data\generate_training_features.py
    deps:
    - path: data\prepared
      md5: 15682c488e4b458bdc8b68fb97c82852.dir
      size: 591595
      nfiles: 1
    - path: src\data\generate_training_features.py
      md5: a6167aa6a67064b54af5fd7da413b192
      size: 5885
    - path: src\models\feature_eng
      md5: 4e377e53668b228b0f8c41ba8a22edba.dir
      size: 35675
      nfiles: 7
    params:
      params.yaml:
        featurize:
          tfidf:
            random_seed: 2023
            dim_reduction: 1
            var_explained: 0.2
            output:
              folder: feature\tfidf
              filename: tfidf.parquet
          count_vector:
            random_seed: 2023
            dim_reduction: 1
            var_explained: 0.9
            output:
              folder: feature\cntvector
              filename: count_vectorizer.parquet
      src/data/train_params.yaml:
        pipeline_type:
          KFoldTE: true
          frequency_encoding: true
          KFold_frequency_encoding: false
          tfidf_vectorizer_encoding: false
          count_vectorizer_encoding: false
        train_test_split:
          test_size: 0.01
          random_seed: 45
          output_folder: feature\train
    outs:
    - path: data\feature\
      md5: 6a07d6919f9958517530e7b55ad5c944.dir
      size: 1472092
      nfiles: 2
  train_model:
    cmd: python src\data\train_model.py
    deps:
    - path: data\feature\
      md5: 6a07d6919f9958517530e7b55ad5c944.dir
      size: 1472092
      nfiles: 2
    - path: src\data\train_model.py
      md5: 4a7d48a1ac740bb937e6d6ca598ee072
      size: 3892
    params:
      src/data/train_params.yaml:
        model:
          model_type: logistic_reg
          params:
            max_iter: 2000
            penalty: l2
            class_weight: balanced
          trained_model: model\model.pkl
    outs:
    - path: data\model
      md5: 490288318d1cc3bf3a00e889b2ef2cb5.dir
      size: 5613
      nfiles: 1
  evaluate_model:
    cmd: python src\data\eval.py
    deps:
    - path: data\model
      md5: 490288318d1cc3bf3a00e889b2ef2cb5.dir
      size: 5613
      nfiles: 1
    - path: src\data\eval.py
      md5: 44adae0058e038cc40db2c4af28f8981
      size: 10064
    outs:
    - path: data\eval\metrics\metrics.json
      md5: caddae0d38f0f01fc68f3aa008fe6e06
      size: 136
    - path: data\eval\plots\sklearn\Confusion_Matrix.json
      md5: e06d16bc596b9baa761e74c9cb80bf69
      size: 2530919
    - path: data\eval\plots\sklearn\Precision_Recall_Curve.json
      md5: 1fe69bb3bd3381f51caccfab82705e9c
      size: 4274567
    - path: data\eval\plots\sklearn\ROC.json
      md5: f8e073a60dd88720ee70e2b14fe783a4
      size: 760570
    - path: data\eval\plots\sklearn\confusion_matrix.png
      md5: ebe9762a08045ca8d9814a9620fbb729
      size: 16123
